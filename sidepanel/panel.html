<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zotero Archivist</title>
    <link rel="stylesheet" href="panel.css">
  </head>
  <body>
    <main class="panel">
      <header class="app-header">
        <div class="header-main">
          <h1>Zotero Archivist</h1>
          <button id="collect-links-button" type="button" class="primary-action-button">Collect Links</button>
        </div>
        <p id="status" class="status-line" role="status"></p>
      </header>

      <section class="section selectors" aria-live="polite">
        <div class="section-header">
          <h2 class="section-heading">
            <button
              id="selectors-toggle-button"
              class="section-toggle"
              type="button"
              aria-expanded="false"
              aria-controls="selectors-body"
            >
              <span>Selector Rules</span>
            </button>
          </h2>
          <div class="section-actions">
            <button id="add-rule-button" type="button" class="icon-button" aria-label="Add Rule" title="Add Rule">+</button>
            <button id="save-rules-button" type="button" class="icon-button" aria-label="Save Rules" title="Save Rules">ðŸ’¾</button>
          </div>
        </div>
        <div id="selectors-body" class="section-body" hidden>
          <ul id="selector-rules-list" class="selector-rules-list"></ul>
          <p id="rules-summary" class="rules-summary-text"></p>
        </div>
      </section>

      <div id="workspace" class="workspace">
        <section id="results-section" class="section results" aria-live="polite">
          <div class="section-header">
            <h2 class="section-heading">
              <button
                id="results-toggle-button"
                class="section-toggle"
                type="button"
                aria-expanded="true"
                aria-controls="results-body"
              >
                <span id="results-title">Collected Links</span>
              </button>
            </h2>
            <p id="results-summary" class="section-meta"></p>
          </div>

          <div id="results-body" class="section-body">
            <div class="filter-bar">
              <input
                id="results-filter-input"
                type="search"
                class="filter-input"
                placeholder="Filter links..."
                autocomplete="off"
              >
              <div class="bulk-actions">
                <button id="select-all-links-button" type="button" class="text-button" title="Select All">All</button>
                <button id="deselect-all-links-button" type="button" class="text-button" title="Deselect All">None</button>
                <button id="invert-links-button" type="button" class="text-button" title="Invert Selection">Inv</button>
                <button id="clear-all-links-button" type="button" class="text-button danger" title="Clear All">Clear</button>
              </div>
            </div>
            <ul id="results-list" class="results-list"></ul>
          </div>
        </section>

        <div
          id="workspace-resizer"
          class="workspace-resizer"
          role="separator"
          aria-label="Resize queue section"
          aria-orientation="horizontal"
          tabindex="0"
        ></div>

        <section id="queue-section" class="section queue" aria-live="polite">
          <div class="section-header">
            <div class="queue-header-title-group">
              <h2 class="section-heading">
                <button
                  id="queue-toggle-button"
                  class="section-toggle"
                  type="button"
                  aria-expanded="true"
                  aria-controls="queue-body"
                >
                  <span id="queue-title">Queue</span>
                </button>
              </h2>
              <span id="queue-summary" class="section-meta"></span>
            </div>
            <div class="queue-global-controls">
              <button id="start-queue-button" type="button" class="action-button small">Start</button>
              <button id="pause-queue-button" type="button" class="action-button small">Pause</button>
              <button id="resume-queue-button" type="button" class="action-button small">Resume</button>
              <button id="stop-queue-button" type="button" class="action-button small">Stop</button>
            </div>
          </div>

          <div id="queue-body" class="section-body">
            <div class="queue-toolbar">
              <button id="add-selected-to-queue-button" type="button" class="secondary-button full-width">Add Selected to Queue</button>
            </div>
            <div class="queue-toolbar-secondary">
              <button id="clear-queue-button" type="button" class="text-button danger">Clear Queue</button>
              <button id="clear-archived-queue-button" type="button" class="text-button">Clear Archived</button>
              <button id="reverse-queue-button" type="button" class="text-button">Reverse</button>
              <button id="retry-failed-queue-button" type="button" class="text-button">Retry Failed</button>
            </div>

            <div class="queue-settings-row">
              <label title="Delay in seconds">
                <span>Delay</span>
                <input id="queue-delay-seconds-input" type="number" min="0" step="0.1" class="mini-input">
              </label>
              <label title="Jitter in seconds">
                <span>+/-</span>
                <input id="queue-jitter-seconds-input" type="number" min="0" step="0.1" class="mini-input">
              </label>
              <button id="save-queue-settings-button" type="button" class="text-button">Save</button>
            </div>

            <p id="queue-runtime-status" class="queue-runtime-status"></p>
            <ul id="queue-list" class="queue-list"></ul>
          </div>
        </section>
      </div>

      <footer class="app-footer integration" aria-live="polite">
        <div class="footer-status-line">
          <span id="integration-mode" class="integration-mode-badge"></span>
          <span class="spacer"></span>
          <button id="refresh-diagnostics-button" type="button" class="icon-button small" title="Refresh Status">â†»</button>
        </div>

        <div class="integration-metrics">
          <div id="integration-connector-row" class="status-dot-container" data-state="unknown" title="Zotero Connector">
            <span class="status-dot"></span> <span class="status-label">Ext</span>
          </div>
          <div id="integration-bridge-row" class="status-dot-container" data-state="unknown" title="Bridge">
            <span class="status-dot"></span> <span class="status-label">Bridge</span>
          </div>
          <div id="integration-zotero-row" class="status-dot-container" data-state="unknown" title="Zotero App">
            <span class="status-dot"></span> <span class="status-label">App</span>
          </div>
        </div>
        <p id="integration-error" class="integration-error-toast" hidden></p>
        <span id="integration-updated-at" hidden></span>
        <span id="integration-connector-status" hidden></span>
        <span id="integration-bridge-status" hidden></span>
        <span id="integration-zotero-status" hidden></span>
      </footer>
    </main>

    <script type="module" src="panel.js"></script>
  </body>
</html>
